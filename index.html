<html><head>
<meta charset="utf-8"><!-- 
<link href=style.css rel='stylesheet' type='text/css' />
 -->
<style>
	h1{
		font-family: sans-serif;
    text-align: center;
	}
	div.button{
		font-family: sans-serif;
	}
	div.tooltip {
     position: relative 500px;
     text-align: center;
     padding: .5rem;
     background: #FFFFFF;
     color: #313639;
     /*border: 1px solid #313639;*/
     border-radius: 8px;
     pointer-events: none;
     font-size: 1.3rem;
  }
  #option{
    text-align: center;
  }

  input{
    margin: 10;
  }

  svg{
    margin: 25
  }
  .nodes circle {
  pointer-events: all;
}

</style>
</head>
<body marginwidth="0" marginheight="0">
	<h1> Arthur Ross Greenhouse Collection by Room</h1>
<div id="option" text-align: center >
 	 <input type="radio" name="color" value="lightblue" checked>light blue
 	 <input type="radio" name="color" value="lightgreen">  light green
	</form>
		<input type="button" name="ByRoom" value="room" onclick="roomforce()">
    <input type="button" name="Medicinal" value="medicinal" onclick="growMed()">
    <input type="button" name="noMed" value="All plants" onclick="noMed()">
    <input type="button" name="randomlayout" value="random" onclick="start()">

	</form>
</div>
<br>

<script src="https://d3js.org/d3.v5.min.js"></script>
<script>
//variables that need to be used by all the functions 
var   w = window.innerWidth,
      h = window.innerHeight/4+50,
      margin = { top: 40, right: 20, bottom: 20, left: 40 },
      radius = 5;    

 var svgContainer = d3.select("body").append("svg")
      .attr("width", w)
      .attr("height", h)

 var buttons = d3.selectAll('input');
  
 var medPress = false;
//********************************************************************************
//random layout applied when page loads and when u hit the reset button
//********************************************************************************
function start(){
  d3.csv("plant_list1.csv").then(function(data){

    d3.selectAll("text")
          .remove();

    d3.selectAll("circle")
          .enter()
          .remove();

     buttons.on('change', function(d){
        var circles = svgContainer.selectAll("circle").data(data)
        .attr("fill", this.value)
      })

    var simulation = d3.forceSimulation(data)
      .force('center', d3.forceCenter(w/2, h/2))
      .on('tick', ticked);
      

      function ticked(){

       var circles = d3.select('svg')
        .selectAll("circle")
        .data(data);

       circles.enter()
        .append("circle")
        .attr("r", radius)
        .attr("fill", "lightblue") //go back and make a color scale here 
        .on("mouseover", handleMouseOver)
        .on("mouseout", handleMouseOut)
        .on("dblclick", doubleclick)
        .on("click", click)
        .merge(circles)
        .transition()
        .duration(70)
        .attr("cx", function(d){return d.x})
        .attr("cy", function(d){return d.y})
        

        
     circles.exit().remove();

    }

    function handleMouseOver(d,i){

      d3.select(this)
      .transition()
      .style("fill", "orchid")
      .attr("r", 7)

      div.transition()
        .duration(50)
        .style("opacity", 1)

      div.html(d["Species Name"] + " "+ d["room"] )
        .attr("x", 800 )
        .attr("y", 500 )
    };

  })

}
//***********************************************************************************
// function called when Room button is pressed, applies force layout and room lables
//***********************************************************************************

function roomforce(){
  d3.csv("plant_list1.csv").then(function(data){
 
    //var buttons = d3.selectAll('input');
      buttons.on('change', function(d){
        var circles = svgContainer.selectAll("circle").data(data)
        .attr("fill", this.value)
    })


    var labelText = ["Hallway", "511", "512", "513", "514", "515"]


    var lables1 = svgContainer.selectAll("text")
        .data(labelText)
        .enter()
        .append("text")
        .attr("x", function(d,i){
          return (w/12)*((i*2)+1)
        })
        .attr("y", 175)
        .text(function(d){return d})
        .attr("font-family", "sans-serif")
        .attr("font-size", "15px")
        .attr("id", "roomNum")
  

  var simulation = d3.forceSimulation(data)
      .force('charge', d3.forceManyBody().strength(7))
      .force('xAxis', d3.forceX(function(d){
        return roomX(d)
      }))
      .force('yAxis', d3.forceY(h/3))
      .force('collision', d3.forceCollide().radius(radius+3).iterations([5]))
     // .force('center', d3.forceCenter(w/2, h/2))
      .on('tick', ticked)
      

      function ticked(){

    var circles = d3.select('svg')
      .selectAll("circle")
      .data(data);

    circles.enter()
      .append("circle")
      .attr("r", radius)
      .attr("fill", "lightblue") //go back and make a color scale here 
      .on("mouseover", handleMouseOver)
      .on("mouseout", handleMouseOut)
      .on("dblclick", doubleclick)
      .on("click", click)
      .merge(circles)
      .transition()
      .duration(80)
      .attr("cx", function(d){return Math.abs(d.x)})
      .attr("cy", function(d){return Math.abs(d.y)})
      
        
    circles.exit().remove();

  


}})}



//***********************************************************************************
// necessary variables for the functions 
//***********************************************************************************

    function handleMouseOver(d,i){

    d3.select(this)
    //.transition()
    .style("fill", "orchid")
    .attr("r", 7)

    div.transition()
      .duration(50)
      .style("opacity", 1)

    div.html(d["Species Name"] + " " + d["room"] )
      .attr("x", 800 )
      .attr("y", 500 )
  };

  function handleMouseOut(d,i){
    d3.select(this)
      .transition()
      .style("fill", buttons.value)
      .attr("r", radius)
      
    div.transition()
     .duration('50')
     .style("opacity", 0); 
  };

  function clickedMouseOut(){
      d3.select(this)
        .transition()
        .style("fill", "purple")
        .attr("r", radius)
        
      div.transition()
       .duration('50')
       .style("opacity", 0);
    }

    function doubleclick(d){
      if (d["medicinal"]=="TRUE" && medPress == true){
            d3.select(this)
              .attr("r", radius*2)
              .style("fill", "purple")
              .on("mouseout", medclickedMouseOut)
          }
      else{
        d3.select(this)
          .attr("r", radius)
          .style("fill", "purple")
          .on("mouseout", clickedMouseOut)
      }
     
          
          
     }
    
    function click(d){
      if (d["medicinal"]=="TRUE" && medPress == true){
        d3.select(this)
          .attr("r", radius*2)
          .style("fill", buttons.value)
          .on("mouseout", medUnclickedMouseOut)
      }
      else{
        d3.select(this)
        .style("fill", buttons.value)
        .on("mouseout", handleMouseOut)
    }}

    function medMouseOver(d,i){
      d3.select(this)
      .transition()
      .style("fill", "orchid")
      .attr("r", radius * 2.3)

      div.transition()
        .duration(50)
        .style("opacity", 1)

      div.html(d["Species Name"] + " " + d["room"] )
        .attr("x", 800 )
        .attr("y", 500 )
    }

  function medMoustOut(){
    d3.select(this)
      .transition()
      .style("fill", buttons.value)
      .attr("r", radius*2)
      
       div.transition()
      .duration('50')
      .style("opacity", 0);
  }

  function medclickedMouseOut(){
    d3.select(this)
        .transition()
        .style("fill", "purple")
        .attr("r", radius*2)
        
         div.transition()
        .duration('50')
        .style("opacity", 0);
}

  function medUnclickedMouseOut(){
    d3.select(this)
          .transition()
          .style("fill", buttons.value)
          .attr("r", radius*2)
          
           div.transition()
          .duration('50')
          .style("opacity", 0);
}


  function growMed(){
    medPress = true;

    d3.selectAll("circle").each(function(d,i){
      if(d["medicinal"]== "TRUE"){
        d3.select(this)
          .attr("r", radius*2)
          .on("mouseover", medMouseOver)
          .on("mouseout", medMoustOut)
      }

    })

  }

  function noMed(){
    medPress = false;
    d3.selectAll("circle")
      .attr("r", radius)
      .on("mouseover", handleMouseOver)
      .on("mouseout", handleMouseOut)
  }

  var div = d3.select("body").append("div")
         .attr("id", "tool")
         .attr("class", "tooltip")
         .style("opacity", 0);


  function roomX(d) {  
        if(d["room"]== "511") {
          return (w/12)*3;
        } else if (d["room"]== "512") {
          return (w/12)*5;
        } else if (d["room"] == "513") {
          return (w/12)*7;
        } else if (d["room"]== "514") {
          return (w/12)*9;
        } else if (d["room"]== "515") {
          return (w/12)* 11;
         }  
          else if(d["room"] == "hallway"||"Hallway") {return w/12}
  };

  function fillrooms(d,i) {
    
      if(d["room"] == "511") {
        return "deeppink"
      } else if (d["room"]=="512") {
        return "lightgreen"
      } else if (d["room"] == "513") {
          return "lightsalmon"
        } else if (d["room"] == "514") {
          return "green"
        } else if  (d["room"] =='hallway'){
          return "blue"
        } else if (d["room"] == '515'){
          return "teal"
        }
        else {
          return "brown"
        }
      } ; 


  start();

                                                      
</script>
</div>

</body>
</html>